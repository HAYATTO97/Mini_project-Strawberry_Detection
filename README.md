# LV-GridNav: Language-Vision Guided Grid Navigation with Reinforcement Learning

## 프로젝트 개요
LV-GridNav는 언어 정보와 시각 정보를 결합하여 비정형 그리드 환경에서 최적의 경로를 학습하는 강화학습 기반 내비게이션 시스템입니다. 이 프로젝트는 다양한 시나리오에서 에이전트가 목표 지점까지 효율적으로 이동하는 방법을 학습하는 것을 목표로 합니다.<br>
본 프로젝트는 세종대학교 대학원 수업 `생명과학을 위한 머신러닝 응용 및 실습`의 미니 프로젝트로 수행되었습니다.

## Project Presentation
You can find our final project presentation slides [here](./docs/LV-GridNav_Presentation_20250618.pdf).

## 프로젝트 구조
```
LV-GridNav/
├── agent/             # 에이전트 관련 코드
├── environment/       # 환경 관련 코드
├── scenarios/         # 시나리오 구현
├── utils/             # 유틸리티 함수
└── visualize/         # 시각화 관련 코드
```

## 주요 라이브러리 버전
```
Python: 3.11
NumPy: 2.1.2
PyTorch: 2.5.0+cu121
Matplotlib
```

각 라이브러리의 주요 용도:
- NumPy: 수치 연산 및 배열 처리
- Matplotlib: 학습 과정 및 결과 시각화
- PyTorch: 딥러닝 모델 구현 및 학습

## 주요 기능

### 환경 구성
- (N x N) 크기의 비정형 그리드 환경 (기본값: 7x7)
- 패딩 영역 포함 (기본값: 2)
- 4방향 이동 가능 (상, 하, 좌, 우)
- 다양한 지형 특성:
  - 일반 경로
  - 공사중인 경로 (이동 가능하지만 상대적으로 높은 패널티 - 일반길의 3배)
  - 벽 (이동 불가능한 영역)

### 에이전트 특성
- 세 가지 강화학습 알고리즘 구현:
  1. Policy Iteration: 전체 MDP를 안다는 가정 하에 Value 기반 정책 학습 (policy branch에서 구현)
  2. Q-Learning: Q-table 기반 강화학습 알고리즘
  3. DQN (Deep Q-Network): 딥러닝 기반 강화학습 알고리즘
    - 경험 재생 버퍼 사용
    - Target Network 구현
    - Epsilon-greedy 탐험 전략
- 시각적 인식: CNN 모델을 통해 (m x m) 크기의 주변 환경 인식
- 언어 기반 목표 이해 (시나리오 선정을 통한 변화)

### 시나리오
1. **단일 목표 도달 (시나리오1)**: 랜덤하게 지정된 단일 목표 지점까지 최단 시간 내 도달
   - 목표 지점은 에이전트와 최소 5칸 이상 떨어져 있도록 설정
   - 목표 도달 시 큰 보상 제공
   - (집을 빨리 가야해..!)

2. **최근접 목표 도달 (시나리오2)**: 여러 목표 지점 중 가장 가까운 지점을 선택하여 최단 시간 내 도달
   - 3개의 목표 지점 생성
   - 목표 지점들 사이의 최소 거리 3칸 유지
   - 가장 가까운 목표 지점 도달 시 보상 제공
   - (다이소를 가야 하는데, 여러 지점 중에서 가능하면 가장 빨리 갈 수 있는 곳에 가고 싶어..!)

3. **순회 목표 도달 (시나리오3)**: 여러 목표 지점을 모두 방문하는 최적 경로 학습
   - 3개의 목표 지점 생성
   - 목표 지점들 사이의 최소 거리 3칸 유지
   - 방문한 목표 지점 수에 따라 보상 증가
   - 모든 목표 지점 방문 시 추가 보상 제공
   - ( [다이소=>올리브영=>집]을 가장 빨리 거쳐서 가고 싶어..!)

### 보상 체계
- 기본 이동: -0.1 (STEP_PENALTY)
- 벽 충돌: -5.0 (WALL_PENALTY)
- 공사중인 경로: -0.3 (CONSTRUCTION_PENALTY)
- 목표 도달: +3.0 (GOAL_REWARD)
- 중복 방문: 방문 횟수에 따라 선형적으로 증가하는 패널티
- 모든 목표 방문 완료: 추가 보상

## 라이선스
MIT License
